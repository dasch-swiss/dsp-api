app {
    print-extended-config = false // If true, an extended list of configuration parameters will be printed out at startup.
    print-extended-config = ${?KNORA_WEBAPI_PRINT_EXTENDED_CONFIG}

    // default ask timeout.
    default-timeout = 120 minutes // a timeout here should never happen

    // If true, log all messages sent from and received.
    dump-messages = false

    show-internal-errors = true // If true, clients will see error messages from internal errors. Useful for debugging. If false, those error messages will appear only in the log.

    bcrypt-password-strength = 12 // Value range is 4-31.
    bcrypt-password-strength = ${?KNORA_WEBAPI_BCRYPT_PASSWORD_STRENGTH}


    // this domain will be set in the session cookie. needs to be set to the parent domain
    // under which webapi and sipi will run, i.e. example.com if 'api.example.com' and 'iiif.example.com'
    // are used for webapi and sipi.
    cookie-domain = "0.0.0.0"
    cookie-domain = ${?KNORA_WEBAPI_COOKIE_DOMAIN}

    // DANGER: If true, will accept messages to the /admin/store route, which allows to restore the contend of the triplestore
    allow-reload-over-http = false
    allow-reload-over-http = ${?KNORA_WEBAPI_ALLOW_RELOAD_OVER_HTTP}

    fallback-language = "en"

    // configuration for the JWT authentication
    jwt {
        secret = "UP 4888, nice 4-8-4 steam engine"
        secret = ${?KNORA_WEBAPI_JWT_SECRET_KEY}
        expiration = 30 days
        expiration = ${?KNORA_WEBAPI_JWT_LONGEVITY}
        issuer = ${?KNORA_WEBAPI_JWT_ISSUER}
    }

    dsp-ingest {
        base-url = "http://localhost:3340"
        base-url = ${?KNORA_WEBAPI_DSP_INGEST_BASE_URL}
        audience = "http://localhost:3340"
        audience = ${?KNORA_WEBAPI_DSP_INGEST_AUDIENCE}
    }

    knora-api {
        // relevant for direct communication inside the knora stack
        internal-host = "0.0.0.0"
        internal-host = ${?KNORA_WEBAPI_KNORA_API_INTERNAL_HOST}
        internal-port = 3333
        internal-port = ${?KNORA_WEBAPI_KNORA_API_INTERNAL_PORT}

        // relevant for the client, i.e. browser
        external-protocol = "http" // optional ssl termination needs to be done by the proxy
        external-protocol = ${?KNORA_WEBAPI_KNORA_API_EXTERNAL_PROTOCOL}
        external-host = "0.0.0.0"
        external-host = ${?KNORA_WEBAPI_KNORA_API_EXTERNAL_HOST}
        external-port = 3333
        external-port = ${?KNORA_WEBAPI_KNORA_API_EXTERNAL_PORT}

        external-zio-port = 5555
    }

    sipi {
        // relevant for direct communication inside the knora stack
        internal-protocol = "http"
        internal-protocol = ${?KNORA_WEBAPI_SIPI_INTERNAL_PROTOCOL}
        internal-host = "0.0.0.0"
        internal-host = ${?KNORA_WEBAPI_SIPI_INTERNAL_HOST}
        internal-port = 1024
        internal-port = ${?KNORA_WEBAPI_SIPI_INTERNAL_PORT}

        timeout = 120 seconds

        // relevant for the client, i.e. browser
        external-protocol = "http"
        external-protocol = ${?KNORA_WEBAPI_SIPI_EXTERNAL_PROTOCOL}
        external-host = "0.0.0.0"
        external-host = ${?KNORA_WEBAPI_SIPI_EXTERNAL_HOST}
        external-port = 1024
        external-port = ${?KNORA_WEBAPI_SIPI_EXTERNAL_PORT}

        file-server-path = "server"

        move-file-route = "store"
        delete-temp-file-route = "delete_temp_file"

        image-mime-types = ["image/tiff", "image/jpeg", "image/png", "image/jp2", "image/jpx"]
        document-mime-types = [
            "application/epub+zip",
            "application/pdf",
            "application/msword",
            "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
            "application/vnd.ms-excel",
            "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
            "application/vnd.ms-powerpoint",
            "application/vnd.openxmlformats-officedocument.presentationml.presentation",
        ]
        text-mime-types = [
            "application/json",
            "application/odd+xml",
            "application/rng+xml",
            "application/xml",
            "application/xsd+xml",
            "application/xslt+xml",
            "text/csv",
            "text/html",
            "text/plain",
            "text/xml",
        ]
        video-mime-types = ["video/mp4"]
        audio-mime-types = ["audio/mpeg", "audio/wav", "audio/x-wav", "audio/vnd.wave"]
        archive-mime-types = [
            "application/zip",
            "application/x-tar",
            "application/gzip",
            "application/x-7z-compressed",
            "application/x-compress",
        ]
    }

    ark {
        resolver = "http://0.0.0.0:3336"
        resolver = ${?KNORA_WEBAPI_ARK_RESOLVER_URL}
        assigned-number = 72163
        assigned-number = ${?KNORA_WEBAPI_ARK_NAAN}
    }

    salsah1 {
        base-url = "http://0.0.0.0:3335/"
        base-url = ${?KNORA_WEBAPI_SALSAH1_BASE_URL}
        project-icons-basepath = "project-icons/"
    }

    tmp-datadir = "/tmp/webapi_tmp/" // dir must exist on disk!
    datadir = "/tmp/webapi/" // dir must exist on disk!

    max-results-per-search-result-page = 500

    v2 {
        resources-sequence {
            results-per-page = 25 // results to be returned per page
        },
        fulltext-search {
            search-value-min-length = 3
        },
        graph-route {
            default-graph-depth = 4
            max-graph-depth = 10
            max-graph-breadth = 50
        }
    }

    gui {
        // The default size of resource type icons. TODO: put icon sizes in the triplestore instead.
        default-icon-size {
            dim-x = 32
            dim-y = 32
        }
    }

    # Array containing route paths which should be rejected. This can be used to selectively disable routes
    # in the configuration.
    routes-to-reject = [
        "v1/"
    ]

    triplestore {
        dbtype = "fuseki"
        dbtype = ${?KNORA_WEBAPI_TRIPLESTORE_DBTYPE}

        use-https = false
        use-https = ${?KNORA_WEBAPI_TRIPLESTORE_USE_HTTPS}

        host = "localhost"
        host = ${?KNORA_WEBAPI_TRIPLESTORE_HOST}

        // timeout for triplestore queries.
        query-timeout = 20 seconds

        // timeout for triplestore queries for maintenance actions.
        maintenance-timeout = 120 seconds

        // timeout for Gravsearch queries.
        gravsearch-timeout = 120 seconds

        fuseki {
            port = 3030
            port = ${?KNORA_WEBAPI_TRIPLESTORE_FUSEKI_PORT}
            repository-name = "dsp-repo"
            repository-name = ${?KNORA_WEBAPI_TRIPLESTORE_FUSEKI_REPOSITORY_NAME}
            username = "admin"
            username = ${?KNORA_WEBAPI_TRIPLESTORE_FUSEKI_USERNAME}
            password = "test"
            password = ${?KNORA_WEBAPI_TRIPLESTORE_FUSEKI_PASSWORD}
            query-logging-threshold = 1s
            query-logging-threshold = ${?KNORA_WEBAPI_TRIPLESTORE_FUSEKI_QUERY_LOGGING_THRESHOLD}
            allow-compaction = false
            allow-compaction = ${?KNORA_WEBAPI_TRIPLESTORE_FUSEKI_ALLOW_COMPACTION}
        }

        // If true, the time taken by each SPARQL query is logged at DEBUG level. To see these messages,
        // set loglevel = "DEBUG" above, and
        // <logger name="org.knora.webapi.store.triplestore.http.HttpTriplestoreConnector" level="DEBUG"/>
        // in logback.xml.
        profile-queries = false
    }

    instrumentation-server-config {
        port = 3339
        port = ${?KNORA_INSTRUMENTATION_SERVER_PORT}
        interval = 5 seconds
    }

    features {
        allow-erase-projects = false
        allow-erase-projects = ${?ALLOW_ERASE_PROJECTS}

        trigger-compaction-after-project-erasure = false
        trigger-compaction-after-project-erasure = ${?TRIGGER_COMPACTION_AFTER_PROJECT_ERASURE}

        disable-last-modification-date-check = false
        disable-last-modification-date-check = ${?DISABLE_LAST_MODIFICATION_DATE_CHECK}
    }

    open-telemetry.dsn = ${?WEBAPI_OPENTELEMETRY_DSN}
}
